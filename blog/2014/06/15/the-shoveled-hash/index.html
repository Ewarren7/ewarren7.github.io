
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>The Shoveled Hash - Musings of a Flatiron Ruby Student</title>
  <meta name="author" content="Edward Warren">

  
  <meta name="description" content="Where&rsquo;s My Shovel asks the Hash As a typical Ruby student, I became acquainted with arrays before hashes. The array shovel, aka &lt;&lt; really &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://Ewarren7.github.io/blog/2014/06/15/the-shoveled-hash">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Musings of a Flatiron Ruby Student" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Musings of a Flatiron Ruby Student</a></h1>
  
    <h2>A collection of compulsory weekly musings</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:Ewarren7.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">The Shoveled Hash</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-15T18:50:54-04:00" pubdate data-updated="true">Jun 15<span>th</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><h2>Where&rsquo;s My Shovel asks the Hash</h2>

<p>As a typical Ruby student, I became acquainted with arrays before hashes. The array shovel, aka <code>&lt;&lt;</code> really made sense to me and once I moved on to Hashes I found it very disconcerting that hashes were left shovelless.</p>

<p>Now that my studies have moved into classes and duck punching I decided I would try and give my hashes shovels and see what became of it.</p>

<h2>A hash without a shovel</h2>

<p>If you ever attempted to use a shovel with a hash, the ruby interpreter greets you with:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">{</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="ss">:b</span> <span class="o">=&gt;</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="ss">:c</span> <span class="o">=&gt;</span> <span class="s2">&quot;three&quot;</span><span class="p">}</span> <span class="o">&lt;&lt;</span> <span class="p">{</span><span class="ss">:d</span> <span class="o">=&gt;</span> <span class="s2">&quot;three&quot;</span><span class="p">}</span>
</span><span class='line'><span class="o">=&gt;</span><span class="ss">NoMethodError</span><span class="p">:</span> <span class="n">undefined</span> <span class="nb">method</span> <span class="sb">`&lt;&lt;&#39; for {:a=&gt;&quot;one&quot;, :b=&gt;&quot;two&quot;, :c=&gt;&quot;three&quot;}:Hash</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the above scenario, the main ways to add the <code>{:d =&gt; "three"}</code> to the existing hash would be to use <code>merge!</code> or <code>store</code></p>

<p><code>merge!</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">{</span><span class="ss">:a</span> <span class="o">=&gt;</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="ss">:b</span> <span class="o">=&gt;</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="ss">:c</span> <span class="o">=&gt;</span> <span class="s2">&quot;three&quot;</span><span class="p">}</span><span class="o">.</span><span class="n">merge!</span><span class="p">({</span><span class="ss">:d</span> <span class="o">=&gt;</span> <span class="s2">&quot;three&quot;</span><span class="p">})</span>
</span><span class='line'> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:a</span><span class="o">=&gt;</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="ss">:b</span><span class="o">=&gt;</span><span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="ss">:c</span><span class="o">=&gt;</span><span class="s2">&quot;three&quot;</span><span class="p">,</span> <span class="ss">:d</span><span class="o">=&gt;</span><span class="s2">&quot;three&quot;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>store</code>
 &#8220;`ruby
test = {:a => &ldquo;one&rdquo;, :b => &ldquo;two&rdquo;, :c => &ldquo;three&rdquo;}
 => {:a=>&ldquo;one&rdquo;, :b=>&ldquo;two&rdquo;, :c=>&ldquo;three&rdquo;}</p>

<p>test.store(:d, &ldquo;three&rdquo;)
 => &ldquo;three&rdquo;</p>

<p>test
 => {:a=>&ldquo;one&rdquo;, :b=>&ldquo;two&rdquo;, :c=>&ldquo;three&rdquo;, :d=>&ldquo;three&rdquo;}</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Despite</span> <span class="n">the</span> <span class="n">verbosity</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="nb">methods</span><span class="p">,</span> <span class="n">they</span> <span class="n">also</span> <span class="n">have</span> <span class="n">the</span> <span class="n">affect</span> <span class="n">of</span> <span class="n">replacing</span> <span class="n">a</span> <span class="n">key</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">value</span> <span class="k">if</span> <span class="n">you</span> <span class="sb">`merge!`</span> <span class="ow">or</span> <span class="sb">`store`</span> <span class="n">using</span> <span class="n">a</span> <span class="n">key</span> <span class="n">that</span> <span class="n">already</span> <span class="n">exists</span> <span class="k">in</span> <span class="n">the</span> <span class="nb">hash</span><span class="o">.</span>
</span><span class='line'>
</span><span class='line'><span class="c1">##A hash with a shovel is a beautiful thing </span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
{:a => &ldquo;one&rdquo;, :b => &ldquo;two&rdquo;} &lt;&lt; {:c => &ldquo;three&rdquo;}
=> {:a=>&ldquo;one&rdquo;, :b=>&ldquo;two&rdquo;, :c=>&ldquo;three&rdquo;}</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">The</span> <span class="n">above</span> <span class="n">seems</span> <span class="n">so</span> <span class="n">simple</span> <span class="ow">and</span> <span class="n">elegant</span><span class="o">.</span> <span class="no">Taking</span> <span class="n">it</span> <span class="n">further</span><span class="p">,</span> <span class="n">what</span> <span class="k">if</span> <span class="n">the</span> <span class="n">key</span> <span class="n">you</span> <span class="n">shovel</span> <span class="n">already</span> <span class="n">exists?</span> <span class="no">Wouldn</span><span class="err">&#39;</span><span class="n">t</span> <span class="n">it</span> <span class="n">be</span> <span class="n">nice</span> <span class="k">if</span> <span class="n">the</span> <span class="sb">`&lt;&lt;`</span> <span class="nb">method</span> <span class="n">took</span> <span class="n">the</span> <span class="n">existing</span> <span class="n">value</span> <span class="k">in</span> <span class="n">the</span> <span class="nb">hash</span> <span class="ow">and</span> <span class="n">put</span> <span class="n">it</span> <span class="n">into</span> <span class="n">an</span> <span class="n">array</span> <span class="ow">and</span> <span class="k">then</span> <span class="n">added</span> <span class="n">the</span> <span class="n">passed</span> <span class="n">values?</span> <span class="n">I</span> <span class="n">think</span> <span class="n">so</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
{:a => &ldquo;one&rdquo;, :b => &ldquo;two&rdquo;} &lt;&lt; {:b => &ldquo;an additional b value!!&rdquo;}
=> {:a=>&ldquo;one&rdquo;, :b=>[&ldquo;two&rdquo;, &ldquo;an additional b value!!&rdquo;]}</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">What</span> <span class="k">if</span> <span class="n">the</span> <span class="n">the</span> <span class="n">key</span> <span class="n">exists</span> <span class="ow">and</span> <span class="n">it</span> <span class="n">has</span> <span class="n">a</span> <span class="n">__value</span> <span class="n">that</span> <span class="n">is</span> <span class="n">already</span> <span class="n">an</span> <span class="n">array__?</span> <span class="no">Wouldn</span><span class="err">&#39;</span><span class="n">t</span> <span class="n">it</span> <span class="n">be</span> <span class="n">nice</span> <span class="k">if</span> <span class="n">the</span> <span class="n">shoveled</span> <span class="n">value</span> <span class="n">was</span> <span class="n">justed</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">array?</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
{:a => &ldquo;one&rdquo;, :b => [&ldquo;two&rdquo;, 2]} &lt;&lt; {:b => &ldquo;an additional b value!!&rdquo;}
=> {:a=>&ldquo;one&rdquo;, :b=>[&ldquo;two&rdquo;, 2, &ldquo;an additional b value!!&rdquo;]}</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">###Making the above a reality - duck punching the Hash class</span>
</span><span class='line'><span class="no">Achieving</span> <span class="n">the</span> <span class="n">above</span> <span class="n">can</span> <span class="n">be</span> <span class="n">done</span> <span class="n">by</span> <span class="n">adding</span> <span class="n">to</span> <span class="o">/</span> <span class="n">duck</span> <span class="n">punching</span> <span class="n">the</span> <span class="no">Hash</span> <span class="n">class</span><span class="o">.</span> <span class="no">Defining</span> <span class="n">a</span> <span class="sb">`class Hash`</span> <span class="n">at</span> <span class="n">the</span> <span class="n">top</span> <span class="n">of</span> <span class="n">your</span> <span class="n">ruby</span> <span class="n">script</span> <span class="n">is</span> <span class="n">the</span> <span class="n">simplest</span> <span class="n">way</span> <span class="n">to</span> <span class="n">achieve</span> <span class="n">this</span><span class="o">.</span> <span class="no">The</span> <span class="n">ruby</span> <span class="n">interpretor</span> <span class="n">will</span> <span class="n">read</span> <span class="n">from</span> <span class="n">this</span> <span class="n">version</span> <span class="n">of</span> <span class="n">the</span> <span class="no">Hash</span> <span class="k">class</span> <span class="n">before</span> <span class="n">looking</span> <span class="n">up</span> <span class="n">the</span> <span class="n">main</span> <span class="no">Hash</span> <span class="k">class</span> <span class="n">included</span> <span class="n">with</span> <span class="n">ruby</span><span class="o">.</span> <span class="no">Any</span> <span class="kp">new</span> <span class="nb">methods</span> <span class="n">added</span> <span class="n">will</span> <span class="n">exist</span> <span class="k">in</span> <span class="n">addition</span> <span class="n">to</span> <span class="n">the</span> <span class="n">original</span> <span class="no">Hash</span> <span class="k">class</span> <span class="nb">methods</span><span class="o">.</span>
</span><span class='line'>
</span><span class='line'><span class="n">A</span> <span class="n">very</span> <span class="n">simple</span> <span class="n">implementation</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
class Hash
  def &lt;&lt;(a)</p>

<pre><code>self.merge!(a)
</code></pre>

<p>  end
end</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">With</span> <span class="n">this</span> <span class="n">simple</span> <span class="k">class</span> <span class="nb">method</span> <span class="n">added</span> <span class="n">to</span> <span class="no">Hash</span> <span class="k">class</span> <span class="n">you</span> <span class="n">can</span> <span class="n">now</span> <span class="n">shovel</span> <span class="n">an</span> <span class="n">existing</span> <span class="nb">hash</span> <span class="n">with</span> <span class="n">another</span> <span class="nb">hash</span> <span class="n">passed</span> <span class="k">in</span> <span class="n">the</span> <span class="sb">`{}`</span> <span class="nb">format</span><span class="o">.</span>
</span><span class='line'><span class="no">The</span> <span class="n">ruby</span> <span class="n">interpreter</span> <span class="n">allows</span> <span class="n">you</span> <span class="n">to</span> <span class="k">do</span> <span class="sb">`hash1 &lt;&lt; hash2`</span> <span class="n">whereas</span> <span class="n">most</span> <span class="n">other</span> <span class="nb">methods</span> <span class="n">would</span> <span class="nb">require</span> <span class="n">the</span> <span class="sb">`.`</span><span class="p">,</span> <span class="n">ie</span> <span class="sb">`hash1 &lt;&lt; hash2`</span> <span class="n">is</span> <span class="n">the</span> <span class="n">same</span> <span class="n">as</span> <span class="sb">`hash1.&lt;&lt; hash2`</span><span class="o">.</span> <span class="no">In</span> <span class="n">the</span> <span class="n">above</span> <span class="n">the</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="n">is</span> <span class="n">the</span> <span class="n">passed</span> <span class="n">parameter</span> <span class="n">given</span> <span class="n">after</span> <span class="n">the</span> <span class="sb">`&lt;&lt;`</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
{:a => &ldquo;alpha&rdquo;} &lt;&lt; {:b => &ldquo;bravo&rdquo;}
 => {:a=>&ldquo;alpha&rdquo;, :b=>&ldquo;bravo&rdquo;}</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">###Done with the baby steps</span>
</span><span class='line'><span class="no">While</span> <span class="n">the</span> <span class="n">above</span> <span class="n">is</span> <span class="n">great</span><span class="p">,</span> <span class="n">the</span> <span class="sb">`&lt;&lt;`</span> <span class="nb">method</span> <span class="n">needs</span> <span class="n">to</span> <span class="n">grow</span> <span class="n">a</span> <span class="n">bit</span> <span class="n">to</span> <span class="n">give</span> <span class="n">me</span> <span class="n">the</span> <span class="n">full</span> <span class="n">functionality</span> <span class="n">I</span> <span class="n">described</span> <span class="n">above</span> <span class="p">(</span><span class="n">plus</span> <span class="n">more!</span><span class="p">)</span>
</span><span class='line'><span class="no">Below</span> <span class="n">is</span> <span class="n">my</span> <span class="n">full</span> <span class="no">Hash</span> <span class="k">class</span> <span class="n">duck</span> <span class="n">punch</span><span class="p">,</span> <span class="n">followed</span> <span class="n">by</span> <span class="n">some</span> <span class="n">explanations</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
class Hash
  def &lt;&lt;(a, b=nil)</p>

<pre><code>if a.class == Hash
  passed_key = a.first[0]
  passed_value = a.first[1]
end
if a.class == Array
  passed_key = a[0]
  passed_value = a[1..-1] if a.length &gt; 2 #more than 2 values in passed array means pass_value becomes an array of all the values after [0]
  passed_value = a[1] if a.length == 2 # only 2 values in array so first must be key and 2nd must be value
end
if !b.nil? #if a second argument is passed, treat it as first being the key and second being the value
  passed_key=a
  passed_value = b
end

#IMPLIMENTATION 
if self[passed_key].nil?
  self.merge!({passed_key =&gt; passed_value})
else #if the key passed exists, then take current value of key and put it in array w/ passed valued
  temp = self[passed_key] #grab current value of existing key
    if temp.class == Array #if the existing value is already an array then add to that array
      self[passed_key] &lt;&lt; passed_value
    else
      self[passed_key] = [temp,passed_value] #create an array with original value and passed value
  end
end

return self
</code></pre>

<p>  end</p>

<p>  def self.array</p>

<pre><code>Hash.new {|hash, key| hash[key] = []} 
</code></pre>

<p>  end</p>

<p>end</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#####The optional b parameter</span>
</span><span class='line'><span class="n">I</span> <span class="n">added</span> <span class="n">an</span> <span class="n">optional</span> <span class="n">parameter</span> <span class="sb">`b`</span> <span class="n">which</span> <span class="n">allows</span> <span class="n">you</span> <span class="n">to</span> <span class="n">pass</span> <span class="mi">2</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">the</span> <span class="n">first</span> <span class="n">being</span> <span class="n">the</span> <span class="n">key</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">second</span> <span class="n">being</span> <span class="n">the</span> <span class="n">value</span><span class="o">.</span> <span class="no">Unfortunately</span><span class="p">,</span> <span class="n">ruby</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">let</span> <span class="n">you</span> <span class="n">use</span> <span class="n">the</span> <span class="n">space</span> <span class="sb">`&lt;&lt; `</span> <span class="n">shortcut</span> <span class="n">explained</span> <span class="n">above</span> <span class="k">when</span> <span class="n">passing</span> <span class="n">two</span> <span class="n">parameters</span><span class="o">.</span> <span class="no">Instead</span><span class="p">,</span> <span class="n">the</span> <span class="n">only</span> <span class="n">way</span> <span class="n">to</span> <span class="n">pass</span> <span class="n">this</span> <span class="n">second</span> <span class="n">parameter</span> <span class="p">(</span><span class="n">as</span> <span class="n">far</span> <span class="n">as</span> <span class="n">I</span> <span class="n">know</span><span class="p">)</span> <span class="n">is</span> <span class="n">using</span> <span class="n">the</span> <span class="sb">`hash1.&lt;&lt; key,value`</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
{:a => &ldquo;one&rdquo;, :b => &ldquo;two&rdquo;}.&lt;&lt; :c,&ldquo;three&rdquo;
=> {:a=>&ldquo;one&rdquo;, :b=>&ldquo;two&rdquo;, :c=>&ldquo;three&rdquo;}</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">The</span> <span class="n">rest</span> <span class="n">of</span> <span class="n">this</span> <span class="kp">new</span> <span class="sb">`&lt;&lt;`</span> <span class="nb">method</span> <span class="n">expects</span> <span class="n">only</span> <span class="n">one</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">thus</span> <span class="n">the</span> <span class="n">space</span> <span class="sb">`&lt;&lt;`</span> <span class="n">space</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span><span class="o">.</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#####The conditional class checks at the top</span>
</span><span class='line'><span class="no">The</span> <span class="n">initial</span> <span class="k">if</span> <span class="n">statements</span> <span class="n">determine</span> <span class="n">the</span> <span class="k">class</span> <span class="n">type</span> <span class="n">of</span> <span class="n">the</span> <span class="n">parameter</span> <span class="n">passed</span> <span class="ow">and</span> <span class="k">break</span> <span class="n">it</span> <span class="n">into</span> <span class="n">a</span> <span class="n">key</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">value</span> <span class="n">assigned</span> <span class="n">to</span> <span class="sb">`passed_key`</span> <span class="ow">and</span> <span class="sb">`passed_value`</span> <span class="n">respectively</span><span class="o">.</span>
</span><span class='line'>
</span><span class='line'><span class="no">The</span> <span class="n">array</span> <span class="nb">method</span> <span class="n">conditional</span> <span class="n">allows</span> <span class="n">you</span> <span class="n">to</span> <span class="n">pass</span> <span class="n">a</span> <span class="n">single</span> <span class="n">parameter</span> <span class="n">as</span> <span class="n">an</span> <span class="n">array</span><span class="o">.</span> <span class="no">The</span> <span class="n">first</span> <span class="n">element</span> <span class="n">of</span> <span class="n">the</span> <span class="n">array</span> <span class="n">will</span> <span class="n">be</span> <span class="n">treated</span> <span class="n">as</span> <span class="n">the</span> <span class="n">key</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">subsequent</span> <span class="n">ones</span> <span class="n">will</span> <span class="n">be</span> <span class="n">values</span><span class="o">.</span> <span class="no">If</span> <span class="n">there</span> <span class="n">are</span> <span class="n">multiple</span> <span class="n">values</span> <span class="n">passed</span> <span class="n">they</span> <span class="n">are</span> <span class="n">kept</span> <span class="k">in</span> <span class="n">array</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
{:a => &ldquo;one&rdquo;, :b => &ldquo;two&rdquo;} &lt;&lt; [:c, &ldquo;three&rdquo;]
=> {:a=>&ldquo;one&rdquo;, :b=>&ldquo;two&rdquo;, :c=>&ldquo;three&rdquo;}</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#####The implementation </span>
</span><span class='line'><span class="no">The</span> <span class="n">first</span> <span class="n">step</span> <span class="n">under</span> <span class="c1">#IMPLEMENTATION is to see if the hash that is being added to already has a key with the same name as the key bing passed. When accessing a non existent hash key, the ruby interpreter will return nil. Thus if `self[passed_key].nil?` equals true, then the key does not exist in the original hash and a simple merge! can be used. </span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="no">If</span> <span class="n">the</span> <span class="n">key</span> <span class="n">does</span> <span class="n">exist</span><span class="p">,</span> <span class="k">then</span> <span class="n">the</span> <span class="n">existing</span> <span class="n">value</span> <span class="n">is</span> <span class="n">put</span> <span class="n">into</span> <span class="n">an</span> <span class="n">array</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">passed</span> <span class="n">value</span> <span class="n">is</span> <span class="n">added</span> <span class="n">to</span> <span class="n">that</span> <span class="n">array</span><span class="o">.</span> <span class="no">If</span> <span class="n">the</span> <span class="n">existing</span> <span class="n">value</span> <span class="n">is</span> <span class="n">already</span> <span class="n">an</span> <span class="n">array</span> <span class="k">then</span> <span class="n">the</span> <span class="n">passed</span> <span class="n">value</span> <span class="n">is</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">array</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
 {:a => &ldquo;one&rdquo;, :b => &ldquo;two&rdquo;, :c => [&ldquo;three&rdquo;, &ldquo;additional value&rdquo;]} &lt;&lt; {:c => &ldquo;a third value&rdquo;}
=> {:a=>&ldquo;one&rdquo;, :b=>&ldquo;two&rdquo;, :c=>[&ldquo;three&rdquo;, &ldquo;additional value&rdquo;, &ldquo;a third value&rdquo;]}</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">####The final bit</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
def self.array</p>

<pre><code>Hash.new {|hash, key| hash[key] = []} 
</code></pre>

<p>end</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">This</span> <span class="nb">method</span> <span class="n">is</span> <span class="n">a</span> <span class="n">little</span> <span class="n">different</span> <span class="n">from</span> <span class="n">the</span> <span class="n">main</span> <span class="n">topic</span> <span class="n">of</span> <span class="n">the</span> <span class="n">post</span><span class="o">.</span> <span class="no">However</span><span class="p">,</span> <span class="k">while</span> <span class="n">I</span> <span class="n">was</span> <span class="n">ducking</span> <span class="n">punching</span> <span class="n">the</span> <span class="nb">hash</span> <span class="k">class</span> <span class="nc">I</span> <span class="n">figured</span> <span class="n">I</span><span class="s1">&#39;d add in a simple but very useful functionality that also relates to the `&lt;&lt;`. This functionality is based on fellow classmate [Peter&#39;</span><span class="n">s</span> <span class="n">blog</span> <span class="n">post</span><span class="o">]</span><span class="p">(</span><span class="ss">http</span><span class="p">:</span><span class="sr">//</span><span class="n">pcrglennon</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="mi">2014</span><span class="o">/</span><span class="mo">06</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="n">rubys</span><span class="o">-</span><span class="nb">hash</span><span class="o">-</span><span class="n">dot</span><span class="o">-</span><span class="kp">new</span><span class="o">-</span><span class="ow">and</span><span class="o">-%</span><span class="mi">7</span><span class="n">B</span><span class="o">%</span><span class="mi">7</span><span class="n">D</span><span class="o">/</span><span class="p">)</span> <span class="n">regarding</span> <span class="n">initializing</span> <span class="n">a</span> <span class="nb">hash</span> <span class="n">with</span> <span class="n">empty</span> <span class="n">array</span> <span class="n">values</span><span class="o">.</span>
</span><span class='line'>
</span><span class='line'><span class="no">Instead</span> <span class="n">of</span> <span class="n">having</span> <span class="n">to</span> <span class="n">type</span> <span class="n">out</span> <span class="sb">`a = Hash.new {|hash, key| hash[key] = []}`</span> <span class="n">I</span> <span class="n">can</span> <span class="n">just</span> <span class="n">type</span> <span class="sb">`a = Hash.array`</span><span class="o">.</span> <span class="no">Both</span> <span class="n">of</span> <span class="n">these</span> <span class="kp">initialize</span> <span class="n">an</span> <span class="n">empty</span> <span class="nb">hash</span> <span class="n">with</span> <span class="n">a</span> <span class="n">default</span> <span class="n">value</span> <span class="n">of</span> <span class="n">an</span> <span class="n">empty</span> <span class="n">array</span><span class="o">.</span> <span class="no">This</span> <span class="n">allows</span> <span class="n">you</span> <span class="n">to</span>  <span class="n">add</span> <span class="n">to</span> <span class="n">the</span> <span class="nb">hash</span> <span class="n">by</span> <span class="n">specifying</span> <span class="n">a</span> <span class="kp">new</span> <span class="ow">or</span> <span class="n">existing</span> <span class="n">key</span> <span class="ow">and</span> <span class="n">using</span> <span class="n">a</span> <span class="n">shovel</span> <span class="n">to</span> <span class="n">add</span> <span class="n">to</span> <span class="n">the</span> <span class="n">array</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>ruby
a = Hash.array
=> {}</p>

<p>a[:new_key] &lt;&lt; &ldquo;Value to be added to value array&rdquo;
=> [&ldquo;Value to be added to value array&rdquo;]</p>

<p>a
=> {:new_key=>[&ldquo;Value to be added to value array&rdquo;]}
&#8220;`</p>

<h2>Practicality</h2>

<p>It is admittedly not convenient to add this lengthy duck punch at the top of your scripts. You could put this code in a separate file and <code>include</code> it, but not only does every person running your ruby code also need the class modification, doing this may create confusion since it is not part of the normal ruby Hash class.</p>

<p>With that said, this new method does add functionality that comports with the style already used for <code>&lt;&lt;</code> and arrays, thus giving a code reader contextual clues that strongly hint at the methods functionality. Additionally, it is my hope that this experiment provides a basis for the consideration and discussion of possibly seeing how a shovel could be introduced as an official method to the Hash class.</p>

<p><em>Tested using Ruby Version 2.1.2</em></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Edward Warren</span></span>

      








  


<time datetime="2014-06-15T18:50:54-04:00" pubdate data-updated="true">Jun 15<span>th</span>, 2014</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://Ewarren7.github.io/blog/2014/06/15/the-shoveled-hash/" data-via="" data-counturl="http://Ewarren7.github.io/blog/2014/06/15/the-shoveled-hash/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/06/15/my-first-post-on-octopress/" title="Previous Post: My First Post On Octopress">&laquo; My First Post On Octopress</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/06/15/the-shoveled-hash/">The Shoveled Hash</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/15/my-first-post-on-octopress/">My First Post on Octopress</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Edward Warren -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
